<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>حاسبة المسافات بين الولايات</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            padding: 25px;
            width: 100%;
            max-width: 500px;
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 25px;
            font-size: 26px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 10px;
            color: #34495e;
            font-weight: bold;
            font-size: 16px;
        }

        select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            margin-bottom: 10px;
            text-align: right;
            transition: all 0.3s ease;
        }

        select:focus {
            border-color: #3498db;
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }

        .result {
            background: linear-gradient(135deg, #e0f7fa 0%, #b2ebf2 100%);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin-top: 25px;
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .loading {
            display: none;
            text-align: center;
            margin: 20px 0;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 10px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result.show {
            display: block;
        }

        .distance {
            font-size: 28px;
            color: #2980b9;
            font-weight: bold;
            margin: 15px 0;
        }

        .error {
            background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
            color: #c62828;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin-top: 25px;
            display: none;
        }

        .error.show {
            display: block;
        }

        .note {
            font-size: 14px;
            color: #546e7a;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>حاسبة المسافات بين الولايات</h1>
        
        <div class="form-group">
            <label for="wilaya1">الولاية الأولى</label>
            <select id="wilaya1">
                <option value="">اختر الولاية الأولى</option>
            </select>
        </div>

        <div class="form-group">
            <label for="wilaya2">الولاية الثانية</label>
            <select id="wilaya2">
                <option value="">اختر الولاية الثانية</option>
            </select>
        </div>

        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>جاري حساب المسافة...</p>
        </div>

        <div id="result" class="result">
            <p>المسافة بين <span id="start-wilaya"></span> و <span id="end-wilaya"></span> هي:</p>
            <div class="distance"><span id="distance-value"></span> كم</div>
            <p class="note">المسافة عبر الطرق الرئيسية</p>
        </div>

        <div id="error" class="error"></div>
    </div>

    <script>
        // Wilaya data with precise coordinates
        const wilayaData = {
            "أدرار": { code: "01", coordinates: [27.8742, -0.2939] },
            "الشلف": { code: "02", coordinates: [36.1647, 1.3317] },
            "الأغواط": { code: "03", coordinates: [33.8000, 2.8650] },
            "أم البواقي": { code: "04", coordinates: [35.8750, 7.1139] },
            "باتنة": { code: "05", coordinates: [35.5550, 6.1742] },
            "بجاية": { code: "06", coordinates: [36.7514, 5.0556] },
            "بسكرة": { code: "07", coordinates: [34.8500, 5.7333] },
            "بشار": { code: "08", coordinates: [31.6231, -2.2158] },
            "البليدة": { code: "09", coordinates: [36.4700, 2.8300] },
            "البويرة": { code: "10", coordinates: [36.3750, 3.9000] },
            "تمنراست": { code: "11", coordinates: [22.7850, 5.5228] },
            "تبسة": { code: "12", coordinates: [35.4000, 8.1200] },
            "تلمسان": { code: "13", coordinates: [34.8783, -1.3150] },
            "تيارت": { code: "14", coordinates: [35.3714, 1.3217] },
            "تيزي وزو": { code: "15", coordinates: [36.7169, 4.0497] },
            "الجزائر": { code: "16", coordinates: [36.7538, 3.0588] },
            "الجلفة": { code: "17", coordinates: [34.6703, 3.2500] },
            "جيجل": { code: "18", coordinates: [36.8206, 5.7667] },
            "سطيف": { code: "19", coordinates: [36.1900, 5.4100] },
            "سعيدة": { code: "20", coordinates: [34.8303, 0.1517] },
            "سكيكدة": { code: "21", coordinates: [36.8667, 6.9000] },
            "سيدي بلعباس": { code: "22", coordinates: [35.1917, -0.6300] },
            "عنابة": { code: "23", coordinates: [36.9000, 7.7667] },
            "قالمة": { code: "24", coordinates: [36.4628, 7.4331] },
            "قسنطينة": { code: "25", coordinates: [36.3650, 6.6147] },
            "المدية": { code: "26", coordinates: [36.2675, 2.7500] },
            "مستغانم": { code: "27", coordinates: [35.9311, 0.0892] },
            "المسيلة": { code: "28", coordinates: [35.7058, 4.5447] },
            "معسكر": { code: "29", coordinates: [35.4000, 0.1400] },
            "ورقلة": { code: "30", coordinates: [31.9500, 5.3333] },
            "وهران": { code: "31", coordinates: [35.6969, -0.6331] },
            "البيض": { code: "32", coordinates: [33.6883, 1.0153] },
            "إليزي": { code: "33", coordinates: [26.5067, 8.4800] },
            "برج بوعريريج": { code: "34", coordinates: [36.0733, 4.7633] },
            "بومرداس": { code: "35", coordinates: [36.7667, 3.4767] },
            "الطارف": { code: "36", coordinates: [36.7667, 8.3167] },
            "تندوف": { code: "37", coordinates: [27.6742, -8.1478] },
            "تيسمسيلت": { code: "38", coordinates: [35.6072, 1.8106] },
            "الوادي": { code: "39", coordinates: [33.3683, 6.8675] },
            "خنشلة": { code: "40", coordinates: [35.4333, 7.1433] },
            "سوق أهراس": { code: "41", coordinates: [36.2864, 7.9511] },
            "تيبازة": { code: "42", coordinates: [36.5892, 2.4481] },
            "ميلة": { code: "43", coordinates: [36.4500, 6.2667] },
            "عين الدفلى": { code: "44", coordinates: [36.2639, 1.9675] },
            "النعامة": { code: "45", coordinates: [33.2667, -0.3167] },
            "عين تموشنت": { code: "46", coordinates: [35.3000, -1.1400] },
            "غرداية": { code: "47", coordinates: [32.4833, 3.6736] },
            "غليزان": { code: "48", coordinates: [35.7397, 0.5556] }
        };

        // OpenRouteService API configuration
        const ORS_API_KEY = '5b3ce3597851110001cf62486bcb783b711d46cbaaa5196c2c053ee6'; // Replace with your API key
        const ORS_API_URL = 'https://api.openrouteservice.org/v2/directions/driving-car';

        async function calculateDistance(start, end) {
            const startCoords = wilayaData[start].coordinates;
            const endCoords = wilayaData[end].coordinates;

            const url = `${ORS_API_URL}?api_key=${ORS_API_KEY}&start=${startCoords[1]},${startCoords[0]}&end=${endCoords[1]},${endCoords[0]}`;

            try {
                const response = await fetch(url);
                const data = await response.json();

                if (data.features && data.features[0]) {
                    // Convert meters to kilometers and round to nearest integer
                    return Math.round(data.features[0].properties.segments[0].distance / 1000);
                }
                throw new Error('No route found');
            } catch (error) {
                console.error('Error calculating distance:', error);
                throw error;
            }
        }

        // Populate dropdowns
        const wilaya1Select = document.getElementById('wilaya1');
        const wilaya2Select = document.getElementById('wilaya2');
        const resultDiv = document.getElementById('result');
        const errorDiv = document.getElementById('error');
        const loadingDiv = document.getElementById('loading');
        const startWilayaSpan = document.getElementById('start-wilaya');
        const endWilayaSpan = document.getElementById('end-wilaya');
        const distanceValueSpan = document.getElementById('distance-value');

        Object.keys(wilayaData).forEach(wilaya => {
            wilaya1Select.add(new Option(wilaya, wilaya));
            wilaya2Select.add(new Option(wilaya, wilaya));
        });

        async function updateDistance() {
            const wilaya1 = wilaya1Select.value;
            const wilaya2 = wilaya2Select.value;

            if (wilaya1 && wilaya2) {
                if (wilaya1 === wilaya2) {
                    resultDiv.classList.remove('show');
                    errorDiv.textContent = "يرجى اختيار ولايتين مختلفتين";
                    errorDiv.classList.add('show');
                    return;
                }

                loadingDiv.classList.add('show');
                resultDiv.classList.remove('show');
                errorDiv.classList.remove('show');

                try {
                    const distance = await calculateDistance(wilaya1, wilaya2);
                    startWilayaSpan.textContent = wilaya1;
                    endWilayaSpan.textContent = wilaya2;
                    distanceValueSpan.textContent = distance;
                    loadingDiv.classList.remove('show');
                    resultDiv.classList.add('show');
                } catch (error) {
                    loadingDiv.classList.remove('show');
                    errorDiv.textContent = "عذراً، حدث خطأ أثناء حساب المسافة. يرجى المحاولة مرة أخرى.";
                    errorDiv.classList.add('show');
                }
            } else {
                resultDiv.classList.remove('show');
                errorDiv.classList.remove('show');
            }
        }

        wilaya1Select.addEventListener('change', updateDistance);
        wilaya2Select.addEventListener('change', updateDistance);
    </script>
</body>
</html>